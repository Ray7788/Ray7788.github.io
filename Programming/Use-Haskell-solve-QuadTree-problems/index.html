<!DOCTYPE html>
<html lang="en">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>é€šè¿‡å‡½æ•°å¼ç¼–ç¨‹å’Œå››å‰æ ‘æ¨¡å‹è§£å†³åŒå€¼å›¾åƒçš„è‰²å½©å¤„ç†é—®é¢˜ Using Haskell to solve QuadTree problems - Ray</title>
  
    <link rel="shortcut icon" href="/source/personal/rui.jpg">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="é€šè¿‡å‡½æ•°å¼ç¼–ç¨‹å’Œå››å‰æ ‘æ¨¡å‹è§£å†³åŒå€¼å›¾åƒçš„è‰²å½©å¤„ç†é—®é¢˜ Using Haskell to solve QuadTree problems - Ray" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://example.com/Programming/Use-Haskell-solve-QuadTree-problems/index.html" />
  
  <meta property="og:image" content="/img/Haskell00.png" />
  
  <meta property="og:article:published_time" content="2023-06-25T00:34:40.000Z" />
  
  <meta property="og:article:author" content="Rui Xu" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Ray</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/projects">Projects</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/Ray7788" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/Programming/">Programming</a>
        
        </div>
        

        

        <h1 class="title">é€šè¿‡å‡½æ•°å¼ç¼–ç¨‹å’Œå››å‰æ ‘æ¨¡å‹è§£å†³åŒå€¼å›¾åƒçš„è‰²å½©å¤„ç†é—®é¢˜ Using Haskell to solve QuadTree problems</h1>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h1 id="é€šè¿‡å‡½æ•°å¼ç¼–ç¨‹å’Œå››å‰æ ‘æ¨¡å‹è§£å†³åŒå€¼å›¾åƒçš„è‰²å½©å¤„ç†é—®é¢˜"><a href="#é€šè¿‡å‡½æ•°å¼ç¼–ç¨‹å’Œå››å‰æ ‘æ¨¡å‹è§£å†³åŒå€¼å›¾åƒçš„è‰²å½©å¤„ç†é—®é¢˜" class="headerlink" title="é€šè¿‡å‡½æ•°å¼ç¼–ç¨‹å’Œå››å‰æ ‘æ¨¡å‹è§£å†³åŒå€¼å›¾åƒçš„è‰²å½©å¤„ç†é—®é¢˜"></a>é€šè¿‡å‡½æ•°å¼ç¼–ç¨‹å’Œå››å‰æ ‘æ¨¡å‹è§£å†³åŒå€¼å›¾åƒçš„è‰²å½©å¤„ç†é—®é¢˜</h1><!--  -->
<h2 id="äºŒå‰æ ‘çš„ä»‹ç»"><a href="#äºŒå‰æ ‘çš„ä»‹ç»" class="headerlink" title="äºŒå‰æ ‘çš„ä»‹ç»"></a>äºŒå‰æ ‘çš„ä»‹ç»</h2><p>å››å‰æ ‘ï¼ˆQuad Treeï¼‰æ˜¯ä¸€ç§æ ‘çŠ¶æ•°æ®ç»“æ„ï¼Œå¯ç”¨äºè¡¨ç¤ºå›¾åƒã€‚åœ¨æ¯ä¸€ä¸ªå››å‰æ ‘ä¼šæœ‰å››ä¸ªå­åŒºå—ã€‚å››å‰æ ‘å¸¸åº”ç”¨äºäºŒç»´ç©ºé—´èµ„æ–™çš„åˆ†æä¸åˆ†ç±»ã€‚ å®ƒå°†èµ„æ–™åŒºåˆ†æˆä¸ºå››ä¸ªè±¡é™ã€‚èµ„æ–™èŒƒå›´å¯ä»¥æ˜¯æ–¹å½¢æˆ–çŸ©å½¢æˆ–å…¶ä»–ä»»æ„å½¢çŠ¶ã€‚è¿™ç§æ•°æ®ç»“æ„æ˜¯ç”± æ‹‰æ–å°”Â·èŠ¬ç§‘å°”(Raphael Finkel) ä¸ J. L. Bentley åœ¨1974å¹´å‘å±•å‡ºæ¥ã€‚ ç±»ä¼¼çš„èµ„æ–™åˆ†å‰²æ–¹æ³•ä¹Ÿç§°ä¸º Q-treeã€‚</p>
<p>æœ¬åšæ–‡ä¸­ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹(Functional Programming)çš„Haskellä½œä¸ºç¼–ç¨‹è¯­è¨€ï¼Œé€šè¿‡é€’å½’æ€æƒ³ï¼Œå®ç°å¯¹ç”±å››å‰æ ‘è¡¨ç¤ºçš„çš„åŒå€¼å›¾åƒçš„è‰²å½©æ£€æµ‹ã€‚</p>
<h2 id="èƒŒæ™¯ä»‹ç»"><a href="#èƒŒæ™¯ä»‹ç»" class="headerlink" title="èƒŒæ™¯ä»‹ç»"></a>èƒŒæ™¯ä»‹ç»</h2><p>å‡è®¾æˆ‘ä»¬éœ€è¦å­˜å‚¨ä¸€å¼ åƒç´ å¤§å°ä¸º 2^{ğ‘›} âˆ— 2^{ğ‘›} çš„æ­£æ–¹å½¢åŒå€¼ï¼ˆé»‘ç™½åŒè‰²ï¼‰å›¾åƒï¼Œä¸€èˆ¬ä½¿ç”¨ä¸€ä¸ªbitï¼ˆ0æˆ–1ï¼‰æ¥å­˜å‚¨ä¸€ä¸ªåƒç´ å€¼ï¼Œéœ€è¦2^{ğ‘›} âˆ— 2^{ğ‘›} bitçš„å­˜å‚¨ç©ºé—´ã€‚ä½†å¦‚æœå›¾åƒä¸­æœ‰å¤§é¢ç§¯çš„å•è‰²åŒºåŸŸï¼Œè¿™ç§å­˜å‚¨æ–¹å¼å¯èƒ½ä¼šé€ æˆæµªè´¹ã€‚</p>
<!-- ![åŸå›¾åƒ](/img/Haskell01.png)![å³ä¸‹è§’æµªè´¹](/img/Haskell02.png)![å·¦ä¸Šè§’ä¹Ÿæµªè´¹](/img/Haskell03.png) -->

<table rules="none" align="center">
    <tr>
        <td>
            <center>
                <img src="/img/Haskell01.png" width="60%">
                <br>
                <font color="AAAAAA">åŸå›¾åƒ</font>
            </center>
        </td>
        <td>
            <center>
                <img src="/img/Haskell02.png" width="60%">
                <br>
                <font color="AAAAAA">å³ä¸‹è§’æµªè´¹</font>
            </center>
        </td>
        <td>
            <center>
                <img src="/img/Haskell03.png" width="60%">
                <br>
                <font color="AAAAAA">å·¦ä¸Šè§’çš„å››åˆ†æ ¼ä¸­ä¹Ÿæµªè´¹</font>
            </center>
        </td>
    </tr>
</table>


<h2 id="è§£å†³æ–¹æ¡ˆå¤§è‡´æ€æƒ³"><a href="#è§£å†³æ–¹æ¡ˆå¤§è‡´æ€æƒ³" class="headerlink" title="è§£å†³æ–¹æ¡ˆå¤§è‡´æ€æƒ³"></a>è§£å†³æ–¹æ¡ˆå¤§è‡´æ€æƒ³</h2><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç®€å•çš„ä¼˜åŒ–æ–¹å¼æ˜¯å°†å›¾åƒåˆ†ä¸ºå››ä¸ªå¤§å°ä¸º 2^{ğ‘›-1} âˆ— 2^{ğ‘›-1} çš„å­å›¾åƒï¼Œæˆ‘ä»¬å°†å…¶ç§°ä¸ºâ€œè±¡é™â€ï¼ˆquadrantsï¼‰ã€‚ å¦‚æœæŸå­å›¾åƒæ˜¯çº¯è‰²å›¾åƒï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å•ä¸€é¢œè‰²ä¿¡æ¯ï¼ˆé»‘è‰²æˆ–ç™½è‰²ï¼‰æ¥è¡¨ç¤ºã€‚ä½†å¦‚æœå®ƒåŒ…å«ä¸åŒçš„é¢œè‰²ï¼ˆé»‘è‰²å’Œç™½è‰²æ··æºï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å†æ¬¡ç»†åˆ†ï¼Œå¹¶ç»§ç»­é€’å½’ï¼Œç›´åˆ°æˆ‘ä»¬å¾—åˆ°åªæœ‰ä¸€ç§é¢œè‰²çš„å­å›¾åƒã€‚ï¼ˆæ­¤æ–¹æ¡ˆç†è®ºä¸Šå¯è¡Œï¼šå¦‚æœæˆ‘ä»¬ä¸æ–­é€’å½’ç›´è‡³å­å›¾åƒç¼©å°åˆ°åŸå§‹åƒç´ çš„æ¯”ä¾‹ï¼Œé—®é¢˜ä¸€å®šèƒ½è§£å†³ï¼‰ã€‚ æˆ‘ä»¬å°†æœ€ç»ˆæ•°æ®ç»“æ„ä¸­çš„è¿™äº›å•ä¸€é¢œè‰²å­å›¾åƒç§°ä¸ºâ€œå•å…ƒâ€ï¼ˆCellï¼‰ã€‚ç°å®ä¸­ï¼Œæˆ‘ä»¬è¿˜è¦è€ƒè™‘å›¾åƒå®é™…å¤§å°ï¼Œè‰²å½©æ ‡å‡†ï¼Œåƒç´ ç»´åº¦ç­‰å¤šé‡å¤æ‚å› ç´ ï¼Œåœ¨æ­¤æˆ‘ä»¬å¿½ç•¥ã€‚</p>
<h2 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h2><p>é¦–å…ˆå®šä¹‰å‡ ç§Algebraic Data Typeï¼Œä¹Ÿå°±æ˜¯ç”¨å…³é”®è¯dataæ¥å®šä¹‰çš„ä»£æ•°æ•°æ®ç±»å‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- åˆå§‹åŒ–é¢œè‰²ï¼ˆé»‘ä¸ç™½ï¼‰ initialise colors' data type </span><br><span class="line">data Color = Black | White deriving (Eq, Show)</span><br></pre></td></tr></table></figure>

<p>è¿™é‡ŒæŠŠå­å›¾åƒå®šä¹‰ä¸ºå››å‰æ ‘ï¼Œçº¯è‰²å›¾åƒï¼ˆCellï¼‰å’Œæ··è‰²å›¾åƒï¼ˆGridï¼‰éƒ½æ˜¯å­å›¾åƒçš„å­é›†ï¼Œå…¶ä¸­æ··è‰²å›¾åƒå¯ä»¥ç»§ç»­ç»†åˆ†ï¼Œç›´è‡³å˜æˆçº¯è‰²å›¾åƒ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- å®ç°å››å‰æ ‘ï¼ˆéµå¾ªæ•°å­¦ä¸­è±¡é™çš„å®šä¹‰æ–¹å¼ï¼šå³ä¸Šè§’ä¸ºç¬¬ä¸€è±¡é™ï¼Œé€†æ—¶é’ˆé€’è¿›ï¼Œå³ä¸‹è§’ä¸ºç¬¬å››è±¡é™ï¼‰ implement QuadTree (the order of quadrant follows mathematical coordinate system)</span><br><span class="line">data QuadTree = Cell Color Int | Grid QuadTree QuadTree QuadTree QuadTree deriving (Eq, Show)</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªå‡½æ•° allBlackï¼Œå®ƒæ¥å—ä¸€ä¸ªæ•´æ•° n å¹¶è¿”å›ä¸€ä¸ªå…¨é»‘çš„å•ä¸ªç»†èƒçš„è¡¨ç¤ºã€‚ å‚æ•° n ä»£è¡¨å›¾åƒâ€œå¤§å°â€ï¼Œä½†ç”±äºä»»ä½•å°ºå¯¸çš„å…¨é»‘å›¾åƒçœ‹èµ·æ¥éƒ½ç›¸åŒï¼Œå› æ­¤å¯ä»¥å¿½ç•¥æ­¤å‚æ•°ï¼ ä½†æ˜¯æˆ‘æ²¡æœ‰å¿½ç•¥ï¼ï¼ï¼ï¼ˆåç»­æœ‰ç”¨â€¦ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- returns a Black or White cell of a specified size</span><br><span class="line">allBlack :: Int -&gt; QuadTree</span><br><span class="line">allBlack size = Cell Black size</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªå‡½æ•° allWhiteï¼Œå®ƒæ¥å—ä¸€ä¸ªæ•´æ•° n å¹¶è¿”å›ä¸€ä¸ªå…¨ç™½çš„å•ä¸ªç»†èƒçš„è¡¨ç¤ºã€‚ å‚æ•° n ä»£è¡¨å›¾åƒâ€œå¤§å°â€ï¼ŒåŒä¸Š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">allWhite :: Int -&gt; QuadTree</span><br><span class="line">allWhite size = Cell White size</span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªé¡ºæ—¶é’ˆå‡½æ•°ï¼Œå®ƒé‡‡ç”¨å››ä¸ªå››å‰æ ‘å¹¶è¿”å›å››å‰æ ‘ï¼Œå…¶å››ä¸ªå­æ ‘æ˜¯ç»™å®šè¾“å…¥ï¼ŒæŒ‰é¡ºæ—¶é’ˆé¡ºåºæ’åˆ—ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- The first quadrant is top-right!</span><br><span class="line">clockwise :: QuadTree -&gt; QuadTree -&gt; QuadTree -&gt; QuadTree -&gt; QuadTree</span><br><span class="line">clockwise a b c d = Grid a b c d</span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªé€†æ—¶é’ˆå‡½æ•°ï¼Œå®ƒé‡‡ç”¨å››ä¸ªå››å‰æ ‘å¹¶è¿”å›å››å‰æ ‘ï¼Œå…¶å››ä¸ªå­æ ‘æ˜¯ç»™å®šè¾“å…¥ï¼ŒæŒ‰é€†æ—¶é’ˆé¡ºåºæ’åˆ—ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">anticlockwise :: QuadTree -&gt; QuadTree -&gt; QuadTree -&gt; QuadTree -&gt; QuadTree</span><br><span class="line">anticlockwise a b c d = Grid a d c b</span><br></pre></td></tr></table></figure>
<p>é¡ºæ—¶é’ˆæ’åºæ˜¯æŒ‡åœ¨a b c dé¡ºæ—¶é’ˆæ–¹å‘çš„å››å‰æ ‘ä¸­ï¼Œå­æ ‘bä½äºaé¡ºæ—¶é’ˆç§»åŠ¨åˆ°è¾¾çš„è±¡é™å†…ï¼Œcä½äºbé¡ºæ—¶é’ˆç§»åŠ¨åˆ°è¾¾çš„è±¡é™å†…ï¼Œdä½äºcé¡ºæ—¶é’ˆç§»åŠ¨åˆ°è¾¾çš„è±¡é™å†…ï¼Œaä½äºä»dé¡ºæ—¶é’ˆç§»åŠ¨åˆ°è¾¾çš„è±¡é™å†…ã€‚åä¹‹äº¦ç„¶ã€‚</p>
<h2 id="é‡å¤´æˆ"><a href="#é‡å¤´æˆ" class="headerlink" title="é‡å¤´æˆ"></a>é‡å¤´æˆ</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦è¿›è¡Œå›¾åƒå¤„ç†ï¼Œå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼šreverseï¼Œå®ƒå°†å››å‰æ ‘ä½œä¸ºè¾“å…¥å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å››å‰æ ‘ä½œä¸ºè¾“å‡ºã€‚ æ­¤å‡½æ•°ä¸åº”è¯¥æ”¹å˜quadtreeçš„ç»“æ„ï¼Œä½†åº”è¯¥æ”¹å˜é‡Œé¢è¡¨ç¤ºé»‘ç™½é¢œè‰²çš„æ•°æ®å†…å®¹ã€‚<br>æ”¹å˜è§„åˆ™å¦‚ä¸‹ï¼š<br><strong>å½“ä¸”ä»…å½“è¶…è¿‡ä¸€åŠçš„é‚»è¾¹æˆ–éƒ¨åˆ†è¾¹ï¼ˆè¿™é‡Œç»Ÿç§°ä¸ºâ€œé‚»å±…â€ï¼‰çš„å•å…ƒé¢œè‰²ä¸æ­¤å•å…ƒè‡ªèº«é¢œè‰²ä¸ä¸€è‡´æ—¶ï¼Œåè½¬æ­¤å•å…ƒçš„é¢œè‰²ï¼ˆå‡è®¾è¯¥å•å…ƒæ ¼åŸå…ˆä¸ºé»‘è‰²çš„è¯ï¼Œç°åœ¨å˜ä¸ºç™½è‰²ï¼‰ã€‚</strong><br>ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªå•å…ƒåœ¨è¾“å…¥qä¸­æ˜¯é»‘è‰²çš„ï¼Œé‚£ä¹ˆå®ƒåœ¨è¾“å‡ºæ¨¡ç³Šqä¸­åº”è¯¥æ˜¯ç™½è‰²çš„ï¼Œå½“ä¸”ä»…å½“åœ¨qä¸­å®ƒçš„é‚»å±…ä¸­ç™½è‰²çš„å•å…ƒå¤šäºé»‘è‰²çš„å•å…ƒã€‚<br>æ­¤å¤„æ³¨æ„ï¼Œå®è§‚æ¥çœ‹ä¸€ä¸ªå®Œæ•´å›¾åƒçš„è¾¹ç•Œå¤„çš„å•å…ƒé€šå¸¸å…·æœ‰è¾ƒå°‘çš„é‚»å±…ã€‚<br><img src="/img/Haskell04.png" alt="æ•ˆæœ1"><br><img src="/img/Haskell05.png" alt="æ•ˆæœ2"></p>
<h1 id="ä»¥ä¸‹æ€è·¯ä»å®è§‚åˆ°å¾®è§‚ä¾æ¬¡ä»‹ç»ï¼Œç›®çš„æ˜¯ä¸ºäº†å¢å¼ºæ€ç»´è¿ç»­æ€§ï¼Œä¾¿äºè¯»è€…ç†è§£"><a href="#ä»¥ä¸‹æ€è·¯ä»å®è§‚åˆ°å¾®è§‚ä¾æ¬¡ä»‹ç»ï¼Œç›®çš„æ˜¯ä¸ºäº†å¢å¼ºæ€ç»´è¿ç»­æ€§ï¼Œä¾¿äºè¯»è€…ç†è§£" class="headerlink" title="ä»¥ä¸‹æ€è·¯ä»å®è§‚åˆ°å¾®è§‚ä¾æ¬¡ä»‹ç»ï¼Œç›®çš„æ˜¯ä¸ºäº†å¢å¼ºæ€ç»´è¿ç»­æ€§ï¼Œä¾¿äºè¯»è€…ç†è§£"></a>ä»¥ä¸‹æ€è·¯ä»<strong>å®è§‚</strong>åˆ°<strong>å¾®è§‚</strong>ä¾æ¬¡ä»‹ç»ï¼Œç›®çš„æ˜¯ä¸ºäº†å¢å¼ºæ€ç»´è¿ç»­æ€§ï¼Œä¾¿äºè¯»è€…ç†è§£</h1><h2 id="æ€è·¯ä»‹ç»ï¼š"><a href="#æ€è·¯ä»‹ç»ï¼š" class="headerlink" title="æ€è·¯ä»‹ç»ï¼š"></a>æ€è·¯ä»‹ç»ï¼š</h2><p>å®Œæˆè¿™ä¸ªä»»åŠ¡æœ‰å‡ ç‚¹è¦è€ƒè™‘ï¼š<br>1 å¿…é¡»ç¡®ä¿å›¾åƒä¸­çš„æ¯ä¸€ä¸ªå•å…ƒéƒ½éå†åˆ°ï¼Œæ‰èƒ½å®Œå…¨è¾“å‡ºæœ€ç»ˆåè½¬åçš„å›¾åƒï¼Œä¸èƒ½æœ‰é—æ¼ï¼Œè¿›ä¸€æ­¥æ¥è®²éœ€è¦çŸ¥é“å“ªäº›å•å…ƒå·²ç»éå†è¿‡äº†ï¼Œå“ªäº›è¿˜æ²¡åˆ°è®¿è¿‡ã€‚<br>2 éå†çš„å‡ºå‘ç‚¹é€‰åœ¨å“ªï¼Ÿä½•æ—¶ç»“æŸéå†ï¼Ÿ<br>3 éå†çš„è·¯çº¿æ˜¯æ€æ ·çš„ï¼Ÿ</p>
<p>å‡ºå‘ç‚¹è®¾åœ¨æ•´ä¸ªå›¾åƒçš„ä¸­å¿ƒï¼Œä¸­å¿ƒä¹Ÿå°±æ˜¯æ•´ä¸ªå›¾åƒé•¿åº¦ã€å®½åº¦çš„å„äºŒåˆ†ä¹‹ä¸€å¤„ï¼ˆä¹Ÿå°±æ˜¯ä¸­ç‚¹ï¼Œä¸€åŠçš„æ„æ€ï¼‰ï¼Œè¿™æ ·å°±æ„æˆäº†ä¸€ä¸ªåæ ‡ç³»ï¼Œç”±æ­¤å¼€å§‹é€’å½’éå†ã€‚<br>ä»¥ä¸‹æ˜¯æ•´ä¸ªç¨‹åºçš„start pointï¼šå¯åŠ¨æ•´ä¸ªç¨‹åºï¼Œè¯¥å‡½æ•°è¾“å…¥ä¸€ä¸ªå››å‰æ ‘ï¼Œè¾“å‡ºå¤„ç†åçš„äºŒå‰æ ‘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- Original Engine of whole programme</span><br><span class="line">-- use reverseMini to implement the tree</span><br><span class="line">reverse :: QuadTree -&gt; QuadTree</span><br><span class="line">reverse fullTree = reverseMini fullTree (fullTree, fullSize) (fullSize / 2, fullSize / 2, fullSize)</span><br><span class="line">  where fullSize = getWholeSize fullTree</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥æ¥æ£’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼šreverseMiniï¼Œè¯¥å‡½æ•°æœ‰å¥½å¤šä¸ªè¾“å…¥å‚æ•°ï¼Œä¾æ¬¡æ˜¯ï¼š<br>å½“å‰æ‰€åœ¨çš„å››å‰æ ‘ï¼Œè¡¨ç¤ºå®Œæ•´å›¾åƒçš„å››å‰æ ‘ï¼Œå®Œæˆå›¾åƒå››å‰æ ‘çš„å¤§å°ï¼Œéå†è¿‡ç¨‹ä¸­ç›®å‰æ‰€åœ¨çš„ç‚¹çš„åæ ‡ï¼ˆxå’Œyï¼‰ï¼Œå½“å‰æ‰€åœ¨å››å‰æ ‘çš„å¤§å°ã€‚<br>è¾“å‡ºçš„å››å‰æ ‘å°±æ˜¯è¿”å›ç»™reverseçš„æœ€ç»ˆç­”æ¡ˆï¼Œä»¥ä¸‹æ˜¯ç»†èŠ‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">-- According to neighbor's weight to decide if it should reverse the color</span><br><span class="line">-- Current QuadTree -&gt; (initial QuadTree, initial QuadTree size) -&gt; (Current x, y, Current QuadTree size) -&gt; output</span><br><span class="line">reverseMini :: QuadTree -&gt; (QuadTree, Double) -&gt; (Double, Double, Double) -&gt; QuadTree</span><br><span class="line">-- for Cell</span><br><span class="line">reverseMini (Cell ce cellSize) (fullTree, treeSize) (x_now, y_now, _)</span><br><span class="line">  --  more than half of its neighbours have the opposite colour, reverse its colour</span><br><span class="line">  | ce == Black &amp;&amp; (neighborWeight &gt; 0) = Cell White cellSize</span><br><span class="line">  | ce == White &amp;&amp; (neighborWeight &lt; 0) = Cell Black cellSize</span><br><span class="line">  | otherwise = Cell ce cellSize</span><br><span class="line">  where</span><br><span class="line">    neighborWeight = getNeighbourWeight (fullTree, treeSize) (x_now, y_now, fromIntegral cellSize)</span><br><span class="line">-- for Grid, contiinue recursion</span><br><span class="line">reverseMini (Grid a b c d) (fullTree, treeSize) (x_now, y_now, fullSize) =</span><br><span class="line">  clockwise</span><br><span class="line">    (reverseMini a (fullTree, treeSize) (x_now + offset, y_now - offset, fullSize / 2))</span><br><span class="line">    (reverseMini b (fullTree, treeSize) (x_now - offset, y_now - offset, fullSize / 2))</span><br><span class="line">    (reverseMini c (fullTree, treeSize) (x_now - offset, y_now + offset, fullSize / 2))</span><br><span class="line">    (reverseMini d (fullTree, treeSize) (x_now + offset, y_now + offset, fullSize / 2))</span><br><span class="line">  where</span><br><span class="line">    offset = fullSize / 4</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºè¾“å…¥çš„å››å‰æ ‘å¯èƒ½æ˜¯Gridä¹Ÿå¯èƒ½æ˜¯Cellï¼Œåœ¨æ­¤åˆ†ç±»è®¨è®ºï¼š</p>
<ul>
<li>è‹¥è¾“å…¥çš„æ˜¯Cellï¼Œé‚£ä¹ˆç›´æ¥åˆ¤æ–­å½“å‰é¢œè‰²æ˜¯å¦ä¸æƒé‡åŒ¹é…ï¼ŒåŒ¹é…åˆ™Cellé¢œè‰²ä¿æŒä¸å˜ï¼Œè‹¥ä¸åŒ¹é…åˆ™é¢œè‰²åè½¬ã€‚â€œåŒ¹é…â€çš„å«ä¹‰åé¢ä¼šè®²ã€‚</li>
<li>è‹¥è¾“å…¥çš„æ˜¯Gridï¼Œåˆ™è¿›ä¸€æ­¥é€’å½’å½“å‰å››å‰æ ‘çš„å››ä¸ªå­å›¾åƒa,b,c,dï¼ŒåŒæ—¶è‡ªèº«åæ ‡å°†ä¼šå‘ç”Ÿæ”¹å˜ï¼Œè¿ç§»åˆ°ä¸‹ä¸€ä¸ªå­å›¾åƒçš„ä¸­å¿ƒï¼Œç”¨å½“å‰æ‰€åœ¨å››å‰æ ‘çš„å¤§å°æŠ˜åŠæ¥è¡¨ç¤ºå­å›¾åƒçš„å¤§å°ï¼ˆå››ä¸ªå­å›¾åƒå¤§å°ç›¸ç­‰ï¼‰ã€‚</li>
</ul>
<p>é¦–å…ˆè®²ä¸€ä¸‹Celléƒ¨åˆ†çš„è®¾è®¡ï¼Œè¿™é‡Œè®¾è®¡äº†ä¸€ä¸ªæ–¹æ³•æ¥åˆ¤æ–­æ˜¯å¦æœ‰è¶…è¿‡ä¸€åŠçš„é‚»å±…ä¸è‡ªèº«é¢œè‰²ä¸åŒï¼Œæ­¤æ–¹æ³•æŠŠé»‘è‰²èµ‹æƒä¸ºæ•´æ•°-1ï¼Œç™½è‰²èµ‹æƒä¸º+1ã€‚ç„¶åé€šè¿‡è®¡ç®—é‚»å±…çš„æƒé‡ä¹‹å’Œçš„æ­£è´Ÿæ¥å†³å®šæ˜¯å¦ä¸ä¹‹åŒ¹é…ã€‚<br>åœ¨è¿™é‡ŒæŠŠ<strong>è‡ªèº«é¢œè‰²ä¸ºç™½è‰²ä¸”æƒé‡å’Œä¸ºæ­£æ•°ï¼Œæˆ–è€…è‡ªèº«é¢œè‰²ä¸ºé»‘è‰²ä¸”æƒé‡å’Œä¸ºè´Ÿæ•°</strong>éƒ½ç§°ä½œä¸ä¹‹ç›¸åŒ¹é…ã€‚</p>
<p>æ¥ä¸‹æ¥ä»‹ç»å¦‚ä½•é€šè¿‡å‡½æ•°getNeighbourWeightæ¥è®¡ç®—é‚»å±…çš„æƒé‡ä¹‹å’Œã€‚<br>ä¸‹é¢ä¾æ¬¡ä»‹ç»è¾“å…¥å‚æ•°ï¼š<br>è¡¨ç¤ºå®Œæ•´å›¾åƒçš„å››å‰æ ‘ï¼ˆåŸå›¾åƒï¼‰ï¼Œå®Œæ•´å›¾åƒå››å‰æ ‘çš„å¤§å°ï¼Œé‚»å±…å•å…ƒçš„xåæ ‡å’Œyåæ ‡ï¼Œé‚»å±…å•å…ƒçš„è§„æ ¼ï¼›<br>è¾“å‡ºçš„æ˜¯å½“å‰é‚»å±…çš„æƒé‡ä¹‹å’Œã€‚<br>è¿™é‡Œå› ä¸ºé€’å½’è·¯çº¿çš„æ€§è´¨éœ€è¦é€†å‘æ¢æµ‹ï¼Œæ‰€ä»¥getNeighbouræ–¹å‘å’Œborderæ–¹å‘ç›¸åï¼Œä¹Ÿæ˜¯æœ€å·§å¦™çš„åœ°æ–¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- get neighbors weight and sum the total weight of a cell's all neighbors</span><br><span class="line">-- (initial QuadTree, initial QuadTree size) -&gt; (Neighbor Cell's X coordinate, Cell's Y coordinate, Cell's size) -&gt; output</span><br><span class="line">getNeighbourWeight :: (QuadTree, Double) -&gt; (Double, Double, Double) -&gt; Int</span><br><span class="line">getNeighbourWeight (fullTree, treeSize) (x_cell, y_cell, cellSize) =</span><br><span class="line">      border (getNeighbour "up" (fullTree, treeSize) (x_cell, y_cell, cellSize)) "down"</span><br><span class="line">    + border (getNeighbour "down" (fullTree, treeSize) (x_cell, y_cell, cellSize)) "up"</span><br><span class="line">    + border (getNeighbour "left" (fullTree, treeSize) (x_cell, y_cell, cellSize)) "right"</span><br><span class="line">    + border (getNeighbour "right" (fullTree, treeSize) (x_cell, y_cell, cellSize)) "left"</span><br></pre></td></tr></table></figure>
<p> æ­¤å‡½æ•°è¿˜éœ€å€Ÿé‰´å¦å¤–ä¸¤ä¸ªå‡½æ•°ï¼šgetNeighbourå’Œborderã€‚<br> å…ˆä»‹ç»borderå‡½æ•°ï¼Œå…¶è¾“å…¥å‚æ•°ä¸ºï¼š<br> å½“ä¸‹éœ€è¦éå†çš„å››å‰æ ‘ï¼ˆä¹Ÿå¯ä»¥ä¸è¾“å…¥ï¼Œæ­¤æƒ…å†µè¾“å‡ºå€¼ä¸º0ï¼‰ï¼Œæ¢æµ‹æ–¹å‘ï¼Œ<br> è¾“å‡ºçš„æ˜¯æ ¹æ®å•ä¸ªCellé¢œè‰²å¾—å‡ºçš„æƒé‡<br> borderæ˜¯â€œè½å®åˆ°åŸºå±‚â€çš„å‡½æ•°ï¼Œæ‰¿æ‹…äº†çœŸæ­£æ ¹æ®Cellé¢œè‰²èµ‹äºˆå…¶æƒé‡çš„ä»»åŠ¡ï¼šç™½è‰²+1ï¼Œé»‘è‰²-1ï¼Œå¦‚æœä¸æ˜¯æœ€å°Cellï¼ˆæ˜¯Gridï¼‰å°±ç»§ç»­ä¸Šä¸‹å·¦å³é€’å½’ç›´åˆ°æ‰¾åˆ°ç›¸åº”çš„Cellã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-- detect one specified border of a certain Gird/Cell and sum its all cells values(weights) according to colors</span><br><span class="line">-- a Quadtree (or Nothing) -&gt; one of the four inner-borders -&gt;</span><br><span class="line">border :: Maybe QuadTree -&gt; String -&gt; Int</span><br><span class="line">-- invalid</span><br><span class="line">border Nothing _ = 0</span><br><span class="line">-- calculate the weight of the Cell</span><br><span class="line">border (Just (Cell ce _)) _</span><br><span class="line">  | ce == White = 1 -- White cells are worth +1</span><br><span class="line">  | ce == Black = -1 -- black cells are worth -1</span><br><span class="line">--  continue to implement recursion for Grid if cell is not arrived</span><br><span class="line">border (Just (Grid a b c d)) direction</span><br><span class="line">  | direction == "up" = border (Just a) "up" + border (Just b) "up"</span><br><span class="line">  | direction == "left" = border (Just b) "left" + border (Just c) "left"</span><br><span class="line">  | direction == "down" = border (Just c) "down" + border (Just d) "down"</span><br><span class="line">  | direction == "right" = border (Just a) "right" + border (Just d) "right"</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥è¯´getNeighbourï¼Œç”±äºè¯¥å‡½æ•°å¤§é‡è°ƒç”¨äº†getGridï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å…ˆäº†è§£getGridå‡½æ•°ã€‚<br>getGridå‡½æ•°ä½œä¸ºgetNeighbourçš„è¾…åŠ©å‡½æ•°ï¼Œæ˜¯ç¨‹åºä¸­æœ€å¤æ‚çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ ¹æ®getNeighbouræä¾›çš„åæ ‡å˜åŒ–æ¥è¿›ä¸€æ­¥éå†ã€‚<br>è¾“å…¥å‚æ•°ä»‹ç»ï¼š<br>å››å‰æ ‘ï¼Œå››å‰æ ‘çš„å¤§å°ï¼ˆèµ·åˆæ˜¯å®Œæ•´å›¾åƒï¼Œåç»­æ˜¯ä¾¿åˆ©ç›®æ ‡çš„å­å›¾åƒï¼‰ï¼Œå½“å‰æ‰€åœ¨ç‚¹çš„Xï¼ŒYåæ ‡ï¼Œå½“å‰æ‰€å¤„å››å‰æ ‘çš„å¤§å°ï¼Œç›®æ ‡å››å‰æ ‘ï¼ˆå³å°†è¦éå†çš„ï¼‰çš„ä¸­ç‚¹åæ ‡ä»¥åŠå¤§å°</p>
<p>è¯¥å‡½æ•°æœ‰å‡ ç‚¹åŠŸèƒ½ï¼š<br>æ£€æµ‹å½“å‰æ‰€å¤„Gridæ˜¯å¦ä¸ºè¾¹ç•ŒGridï¼Œè‹¥é‡åˆ°è¾¹ç•Œåˆ™åœæ­¢éå†ï¼Œå¦åˆ™å†³å®šä¸‹ä¸€æ­¥éå†çš„ç§»åŠ¨æ–¹å‘ã€‚<br>è¿™é‡Œçš„è¾¹ç•Œçº¿æ¢æµ‹è¿˜æ˜¯ç”¨åæ ‡çš„æ•°å€¼æ¥æ¨ç†å¾—å‡ºï¼ŒæŠŠæœ€å°çš„cellå¤§å°å‡è®¾æˆ1ï¼Œåˆ¤æ–­è¿‡ç¨‹å¯ä»¥ç†è§£ä¸ºå°è¯•æ€§åœ°è¿ˆå‡º0.5æ­¥ï¼Œå¦‚æœè¿ˆå‡ºåçš„åæ ‡å¤§äºä¸´ç•Œç‚¹ï¼ˆå³å®Œæ•´å›¾åƒè¾¹æ¡†çº¿ï¼‰æ—¶ï¼Œåˆ™åœæ­¢ç§»åŠ¨ã€‚<br>è‹¥è¿˜å¯ä»¥ç»§ç»­ç§»åŠ¨ï¼Œåˆ™éœ€è¦ç»™å‡ºä¸‹ä¸€ä¸ªåˆ°è®¿çš„cellçš„ä¸­å¿ƒåæ ‡ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-- helper function for getNeigbor: according to inputed coordinates and inputed size returns the Grid and also detect the boundary.</span><br><span class="line">-- Quadtree -&gt; its size -&gt; (current X coordinate, Y coordinate, size) -&gt; (target's X coordinate, Y coordinate, size) -&gt;</span><br><span class="line">getGrid :: QuadTree -&gt; Double -&gt; (Double, Double, Double) -&gt; (Double, Double, Double) -&gt; Maybe QuadTree</span><br><span class="line">getGrid (Cell ce cellSize) _ _ _ = Just (Cell ce cellSize)</span><br><span class="line">getGrid (Grid a b c d) treeSize (x_now, y_now, sizeNow) (grid_x, grid_y, grid_size)</span><br><span class="line">  -- detect boundary</span><br><span class="line">  -- if it is already near the border, stop moving!</span><br><span class="line">  | grid_x &lt; 0.0 || grid_x &gt; (treeSize - 0.5) || grid_y &lt; 0.0 || grid_y &gt; (treeSize - 0.5) = Nothing</span><br><span class="line">  | sizeNow == grid_size = Just (Grid a b c d)</span><br><span class="line">  | x_now &gt; grid_x &amp;&amp; y_now &gt; grid_y = getGrid b treeSize (x_now - offset, y_now - offset, sizeNow / 2) (grid_x, grid_y, grid_size)</span><br><span class="line">  | x_now &lt; grid_x &amp;&amp; y_now &gt; grid_y = getGrid a treeSize (x_now + offset, y_now - offset, sizeNow / 2) (grid_x, grid_y, grid_size)</span><br><span class="line">  | x_now &gt; grid_x &amp;&amp; y_now &lt; grid_y = getGrid c treeSize (x_now - offset, y_now + offset, sizeNow / 2) (grid_x, grid_y, grid_size)</span><br><span class="line">  | x_now &lt; grid_x &amp;&amp; y_now &lt; grid_y = getGrid d treeSize (x_now + offset, y_now + offset, sizeNow / 2) (grid_x, grid_y, grid_size)</span><br><span class="line">  -- offset means how far the coordinate system should move</span><br><span class="line">  where</span><br><span class="line">    offset = sizeNow / 4</span><br></pre></td></tr></table></figure>

<p>æœ€åæˆ‘ä»¬ä»‹ç»ä¸€ä¸‹getNeighborï¼Œè¾“å…¥å‚æ•°ä¸ºï¼š<br>ç§»åŠ¨æ–¹å‘ï¼ˆè¿›ä¸€æ­¥ä¼ å¯¼ç»™getGridï¼‰ï¼Œè¡¨ç¤ºå®Œæ•´å›¾åƒçš„å››å‰æ ‘ï¼Œå®Œæˆå›¾åƒå››å‰æ ‘çš„å¤§å°ï¼Œç›®æ ‡ç‚¹çš„Xï¼ŒYåæ ‡å’Œå¤§å°ã€‚<br>å…¶ä¸»è¦ä½œç”¨æ˜¯å¦‚ä½•é€’å½’åœ°è°ƒç”¨getGridï¼Œå·§å¦™å†³å®šç§»åŠ¨æ–¹å‘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">--  returns the Quadtree representing one of his four direct neighbors (top, bottom, left, right)</span><br><span class="line">-- direction -&gt; (initial QuadTree, initial QuadTree size) -&gt; (Cell's X coordinate, Cell's Y coordinate, Cell's size)</span><br><span class="line">getNeighbor :: String -&gt; (QuadTree, Double) -&gt; (Double, Double, Double) -&gt; Maybe QuadTree</span><br><span class="line">getNeighbor direction (fullTree, treeSize) (x_cell, y_cell, cellSize)</span><br><span class="line">  | direction == "top" = getGrid fullTree treeSize (tree_center, tree_center, treeSize) (x_cell, y_cell - cellSize, cellSize) -- top</span><br><span class="line">  | direction == "bottom" = getGrid fullTree treeSize (tree_center, tree_center, treeSize) (x_cell, y_cell + cellSize, cellSize) -- bottom</span><br><span class="line">  | direction == "left" = getGrid fullTree treeSize (tree_center, tree_center, treeSize) (x_cell - cellSize, y_cell, cellSize) -- left</span><br><span class="line">  | direction == "right" = getGrid fullTree treeSize (tree_center, tree_center, treeSize) (x_cell + cellSize, y_cell, cellSize) -- right</span><br><span class="line">  where</span><br><span class="line">    tree_center = treeSize / 2</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢è¡¥å……ä¸¤ä¸ªè¾…åŠ©å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªç”¨æ¥è®¡ç®—æŸä¸ªå››å‰æ ‘çš„å¤§å°ï¼Œç¬¬äºŒä¸ªç”¨æ¥ä½œä¸ºé¢œè‰²çš„ä¸­é—´è½¬æ¢å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">-- output the size of a QuadTree by calculating the length of one side (eg. top)</span><br><span class="line">getTreeSize :: QuadTree -&gt; Double</span><br><span class="line">getTreeSize (Cell ce size) = fromIntegral size</span><br><span class="line">getTreeSize (Grid a b c d) = getTreeSize a + getTreeSize b</span><br><span class="line"></span><br><span class="line">-- detect one specified side of a certain Gird/Cell and sum its all cells values according to colors</span><br><span class="line">-- a Quadtree (or Nothing) -&gt; one of the four inside-borders -&gt;</span><br><span class="line">side :: Maybe QuadTree -&gt; String -&gt; Int</span><br><span class="line">-- invalid</span><br><span class="line">side Nothing _ = 0</span><br><span class="line">-- calculate the weight of the Cell</span><br><span class="line">side (Just (Cell ce _)) _</span><br><span class="line">  | ce == White = 1 -- White cells are worth +1</span><br><span class="line">  | ce == Black = -1 -- black cells are worth -1</span><br><span class="line">--  continue to implement recursion for Grid if cell is not arrived</span><br><span class="line">side (Just (Grid a b c d)) direction</span><br><span class="line">  | direction == "top" = side (Just a) "top" + (side (Just b) "top")</span><br><span class="line">  | direction == "bottom" = side (Just c) "bottom" + (side (Just d) "bottom")</span><br><span class="line">  | direction == "left" = side (Just b) "left" + (side (Just c) "left")</span><br><span class="line">  | direction == "right" = side (Just a) "right" + (side (Just d) "right")</span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤ï¼Œå®Œæ•´çš„ä»£ç å·²å…¨éƒ¨å±•ç°ã€‚</p>

    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Rui Xu, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/Haskell/" class="tag">#Haskell</a><a href="/tags/Functional-Programming/" class="tag">#Functional Programming</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/Programming/Using-the-Minimax-Algorithm-to-implement-the-Basic-Human-Machine-Confrontation-Game/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">é€šè¿‡Minimaxç®—æ³•å®ç°åŸºç¡€äººæœºå¯¹æŠ—åšå¼ˆ (Minimax Algorithm)</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/uncategorized/hello-world/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">Hello World</>
                </div>
            </div>
        </a>
        
    </div>

    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/projects" class="item">Projects</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a target="_blank" rel="noopener" href="https://github.com/Ray7788" class="item">GitHub</a>
                
                <a href="ray778@foxmail.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2025 Rui Xu<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        <br>
        <span class="footer-extra-description">æ°¸è¿œç›¸ä¿¡ç¾å¥½çš„äº‹æƒ…å³å°†å‘ç”Ÿã€‚Always believe something great is going to happen.</span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>